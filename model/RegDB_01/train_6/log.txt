===> [Check gpu] [0]
===> [Transform data] [Resize(size=(256, 128), interpolation=PIL.Image.BICUBIC), RandomHorizontalFlip(p=0.5), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])]
 ------------------------------
 Dataset RegDB_01 statistics:
 ------------------------------
 subset   | # ids | # images
 ------------------------------
 Visible  |   206 |     2060
 Thermal  |   206 |     2060
 ------------------------------
 Query    |   206 |     2060
 Gallery  |   206 |     2060
 ------------------------------
 Data Loading Time:	 0.108
 ------------------------------
num_epoch is changed from 100 to 25
We use the scale: 1.0
===> [Save train and model file]
{'gpu_ids': [0], 'flag_exp': 1, 'data_name': 'RegDB_01', 'data_dir': './data/', 'name_output': 'train', 'test_only': False, 'test_dir': './model/RegDB_01/test/', 'test_name': 'last', 'resume_dir': './model/RegDB_01/test/checkpoints/', 'resume_name': '', 'num_cnt': 100000, 'cnt_draw_plot': 1000, 'cnt_draw_samples': 1000, 'cnt_print_loss': 10, 'cnt_test_print_loss': 10, 'test_cnt': 5000, 'cnt_save_modal': 5000, 'h': 256, 'w': 128, 'pad': 0, 'flip': True, 'cnt_warmI2I': 0, 'cnt_warmID': 0, 'apply_pos_cnt': 1000000, 'warm_apply_pos_cnt': 1000000, 'cnt_initialize_pos': 0, 'name_samping': ['P_PAIR', 'N_PAIR'], 'color_jitter': False, 'skip_last_batch': False, 'train_all': True, 'type_domain_label': 0, 'train_batchsize': 1, 'pos_mini_batch': 2, 'neg_mini_batch': 2, 'samp_pos': 2, 'samp_neg': 1, 'step_size_bb': 25000, 'step_size_dis': 25000, 'step_size_gen': 25000, 'lr_backbone': 0.001, 'lr_dis': 0.0001, 'lr_gen': 0.0001, 'beta1': 0.5, 'beta2': 0.999, 'gamma_bb': 0.5, 'gamma_dis': 0.5, 'gamma_gen': 0.5, 'momentum': 0.9, 'weight_decay_bb': 0.0001, 'weight_decay_dis': 0.0001, 'weight_decay_gen': 0.0001, 'flag_nesterov': True, 'random_seed': 777, 'train_workers': 0, 'flag_mean_plot': False, 'flag_synchronize': True, 'val_epoch': 0, 'w_recon_x': 50.0, 'w_cross_x': 50.0, 'w_cycle_x': 50.0, 'w_gan': 20.0, 'w_style_kl': 1.0, 'w_recon_s': 10.0, 'w_CE': 1.0, 'w_trip': 1.0, 'HFL_ratio': 0, 'triplet_margin': 0.5, 'w_trip_reg': 1.0, 'w_lrelu': 0.3, 'droprate': 0.5, 'CE_erasing_p': 0.5, 'all_erasing_p': 0.0, 'att_pose_ratio': 0.5, 'att_style_ratio': 0.5, 'evaluate_category': ['f1'], 'stride': 2, 'ID_TRIP_loss_flag': 0, 'backbone_pro_partpool': 1, 'backbone_pro_typepool': 'avg', 'backbone_pro_pretrained': True, 'backbone_pro_resnet_depth': 50, 'backbone_pro_lr_ratio': 1.0, 'backbone_pro_max_num_conv': 5, 'backbone_pro_max_ouput_dim': 1024, 'fc1_channel': 2048, 'fc2_channel': 1024, 'ID_norm': 'bn', 'ID_act': 'none', 'combine_weight_lr_ratio': 0.01, 'G_input_dim': 3, 'G_n_residual': 4, 'G_pad_type': 'reflect', 'G_res_type': 'basic', 'G_init': 'kaiming', 'G_w_lrelu': 0.3, 'G_tanh': False, 'G_enc_res_norm': 'in', 'G_non_local': 0, 'G_dropout': 0, 'G_dim': 32, 'G_act': 'lrelu', 'G_n_downsamp': 2, 'G_enc_type': 2, 'G_ASPP': True, 'G_style_partpool': 1, 'G_style_typepool': 'avg', 'G_style_resnet_depth': 50, 'G_style_pretrained': True, 'G_self_style': True, 'G_dec_res_norm': 'adain', 'G_dec_type': 2, 'G_mlp_dim': 512, 'G_mlp_n_blk': 3, 'D_input_dim': 3, 'D_norm': 'none', 'D_act': 'lrelu', 'D_w_lrelu': 0.3, 'D_gan_type': 'lsgan', 'D_n_scale': 3, 'D_pad_type': 'reflect', 'D_non_local': 0, 'D_init': 'gaussian', 'D_dim': 32, 'D_n_layer': 2, 'D_LAMBDA': 0.01, 'D_n_res': 4, 'D_type': 2, 'test_multi': False, 'test_ms': '1.0', 'test_batchsize': 64, 'test_workers': 0, 'test_norm': True, 'test_figure': False, 'test_tsne': False, 'test_tsne_num': 15, 'test_RAM': False, 'test_gpu': False, 'test_exp': False, 'test_hist': False, 'test_hist_all': True, 'test_hist_dist': True, 'test_hist_grid': False, 'test_hist_grid_min': 0, 'test_hist_grid_max': 2, 'eval_rerank': False, 'test_sample': True, 'test_latent': False, 'test_walk': False, 'save_all_images': False, 'save_row_images': False, 'save_col_images': False, 'test_show_row_num': 8, 'test_show_col_num': 10, 'visual_last_idx': 0, 'visual_pos_idx': 2, 'visual_neg_idx': 5, 'flag_reverse_figure': False, 'flag_all_figure': False, 'test_IR2_flag': False, 'num_draw_samples_idx_train_a': [10, 30, 50, 70, 90, 110, 130, 150, 170, 190, 210, 230, 250, 270, 290, 310, 330, 350, 370, 390, 410], 'num_draw_samples_idx_train_b': [0, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300, 320, 340, 360, 380, 400], 'num_draw_samples_idx_test_a': [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200], 'num_draw_samples_idx_test_b': [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200], 'num_sample_basic1_train': 10, 'num_sample_basic1_test': 10, 'num_sample_basic2_train': 12, 'num_sample_basic2_test': 12, 'num_sample_latent_change_pivot_train': 2, 'num_sample_latent_change_pivot_test': 2, 'num_sample_latent_change_col_train': 6, 'num_sample_latent_change_col_test': 6, 'flag_latent_change': 3, 'flag_decoder_hold': False, 'num_sample_latent_interp_pivot_train': 3, 'num_sample_latent_interp_pivot_test': 3, 'num_sample_latent_interp_col_train': 2, 'num_sample_latent_interp_col_test': 2, 'bnorm': True, 'cross_reid': True, 'data_flag': 5, 'num_print_rank': 100, 'IR_double_model_flag': False, 'phase_train': 'train_all', 'phase_exp': ['train_all', 'test'], 'test_on': True, 'phase_data': ['train_all', 'gallery', 'query'], 'save_dir': './model/RegDB_01/train_6', 'pin_memory': False, 'set_batchsize': {'train_all': 1, 'gallery': 64, 'query': 64}, 'set_shuffle': {'train_all': True, 'gallery': False, 'query': False}, 'set_workers': {'train_all': 0, 'gallery': 0, 'query': 0}, 'set_droplast': {'train_all': False, 'gallery': False, 'query': False}, 'dataset_sizes': {'train_all': 4120, 'gallery': 2060, 'query': 2060}, 'nclasses': 206, 'use_gpu': True, 'num_epoch': 25, 'total_cnt': 103000, 'etc': '_(ms1.0)'}
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=
opt.DC_content_max_num_conv is changed 5 to 2
Since the output dimension of content encoder is 256 and the input dimension of fc layer is 1024
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=
.
===> [Start training]------------------------------
======================================== [ Epoch 1/25 ] ========================================
[train_all] mode is processing..
